<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta content="IE=edge" http-equiv="X-UA-Compatible" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer" />
    <link rel="apple-touch-icon" sizes="180x180" href="./apple-touch-icon.png">
    <link rel="icon" type="image/png" href="./favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="./favicon-16x16.png" sizes="16x16">
    <link rel="manifest" href="./manifest.json">
    <link rel="mask-icon" href="./safari-pinned-tab.svg" color="#0c3159">
    <meta name="apple-mobile-web-app-title" content="CoSheet">
    <meta name="application-name" content="CoSheet">
    <meta name="theme-color" content="#0c3159">
    <base target="_blank" />
    <title>CoSheet - Chia sẻ link cho bạn bè và cùng chỉnh sửa</title>
    <script>
        if (!(window.location.hash.replace('#', ''))) {
            if (window.location.href.match(/\/([^_][^\*\$\/\?]*)(?:\?.*)?$/)) {
                window.EtherCalc = window.SocialCalc = { _room: RegExp.$1 };
                document.title = SocialCalc._room + " – CoSheet";
            }
            else {
                // Redirect directly to new spreadsheet instead of start page
                window.location = './_new';
            }
        }
        window.addEventListener("message", function (it) {
            if (/"type"\s*:\s*"multi"/.test(it.data)) {
                window.__MULTI__ = (function () { try { return JSON.parse(it.data); } catch (e$) { } }());
            }
        }, false);
    </script>
    <script src="./static/ethercalc.js"></script>
    <script src="./socket.io/socket.io.js"></script>
    <script src="./static/topmenu.js"></script>
    <script src="./static/topmenu-save-handler.js"></script>
    <script src="./static/cosheet-export.js"></script>
    <link rel="stylesheet" type="text/css" href="./static/topmenu.css">
    <script src="./static/xlsx.core.min.js"></script>
    <script src="./zappa/zappa.js"></script>
    <script src="./player/broadcast.js?v=20251126"></script>
    <script src="./player/graph.js?v=20251126"></script>
    <script src="./player/main.js?v=20251126"></script>
    <script>
        var readl10nfile = function (data) {
            for (var k in data) {
                SocialCalc.Constants[k] = data[k];
            }
        }
        $.ajax({
            url: ("./l10n/" + navigator.language + ".json").replace(/de-\w+/, 'de').replace(/zh-Hant/i, 'zh-TW').replace(/fr-\w+/, 'fr').replace(/en-\w+/, 'en'),
            async: false,
            success: function (data) { readl10nfile(data) },
            error: function () {
                $.ajax({
                    url: "./l10n/en.json",
                    async: false,
                    success: function (data) { readl10nfile(data) },
                    error: function () { console.error("Language file not found.") }
                });
            }
        });
    </script>

    <link rel="stylesheet" type="text/css" href="./static/socialcalc.css">
    <link rel="stylesheet" type="text/css" href="./static/layout.css">
    <link rel="stylesheet" type="text/css" href="./static/index.css">
    <link rel="stylesheet" type="text/css" href="./static/vex.css">
    <link rel="stylesheet" type="text/css" href="./static/vex-theme-flat-attack.css">
    <link rel="stylesheet" type="text/css" href="./static/jquery-ui.min.css">
    <style>
        body {
            font-family: verdana, helvetica, sans-serif;
            font-size: small;
        }

        .testclass {
            border: 2px dotted red;
        }

        .testclass2 {
            background-image: url(/images/sc-logo.gif);
        }

        .smaller {
            font-size: smaller;
        }

        .hide {
            display: none;
        }
    </style>
    <link rel="stylesheet" type="text/css" href="./static/makeup.css">
    <link rel="stylesheet" type="text/css" href="./static/graph-layout.css">
    <link rel="stylesheet" type="text/css" href="./static/user-avatars.css?v=3">
    <script src="./static/makeup.js"></script>
    <script src="./static/chart.js"></script>
    <script src="./static/graph-layout.js"></script>
    <script src="./static/sheet-layout.js"></script>
    <script src="./static/edit-layout.js"></script>
    <script src="./static/format-layout.js"></script>
    <script src="./static/animal-names.js?v=2"></script>
    <script src="./static/user-avatars.js?v=2"></script>
</head>

<body onresize="if (typeof doresize != 'undefined') doresize();">
    <div id="msg" style="position:absolute;right:15px;top: 8px; bottom: 80px; display: none">
        <textarea id="msgtext" style="margin-top:10px;width:110px;height:100%;"></textarea><br>
        <form id="msgform">
            <input type="text" id="msgout" name="msgout" style="width: 110px">
            <br>
            <input type="submit" style="font-size:x-small;" value="Add a line"
                onclick="val = document.getElementById('msgout').value; if (/\S/.test(val)) {SocialCalc.Callbacks.broadcast('chat', {msg: val}); addmsg(val, false); document.getElementById('msgout').value = ''}; return false"><br>
        </form>
    </div>
    <div id="tableeditor">&nbsp;<div class="loader"></div>
    </div>
    <input id="__fileopen_input" type="file" style="display:none" accept=".csv,.xlsx,.ods" />
</body>

</html>