<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<title>CoSheet Multi-sheet</title>
<style>
body{margin:0;padding:0;font-family:Helvetica,Arial,sans-serif;overflow:hidden}
.iframe-container{position:absolute;top:0;left:0;right:0;bottom:40px}
iframe{width:100%;height:100%;border:0;display:none}
iframe.active{display:block}
.tabs{position:absolute;bottom:0;left:0;right:0;height:40px;background:#eee;border-top:1px solid #ccc;overflow-x:auto;white-space:nowrap;padding:8px 10px}
.tab{display:inline-block;padding:8px 16px;margin-right:4px;background:#ccc;border:1px solid #999;border-radius:4px 4px 0 0;cursor:pointer}
.tab:hover{background:#ddd}
.tab.active{background:#fff;border-bottom-color:#fff;margin-bottom:-1px;font-weight:bold}
.loading{text-align:center;padding:50px;font-size:18px;color:#666}
</style>
</head>
<body>
<div class="iframe-container" id="iframe-container"></div>
<div class="tabs" id="tabs"></div>
<script>
(function(){var a=window.location.pathname.match(/\/=([^\/\?]+)/);if(!a){document.getElementById('iframe-container').innerHTML='<div class="loading">Invalid URL</div>';return}var b=a[1],c='/edit/static/toc-'+b+'.json';document.getElementById('iframe-container').innerHTML='<div class="loading">Loading sheets...</div>';fetch(c).then(function(d){if(!d.ok)throw new Error('TOC not found');return d.json()}).then(function(d){var e=[];for(var f=1;f<d.length;f++)e.push({url:d[f][0],title:d[f][1]});if(e.length===0){document.getElementById('iframe-container').innerHTML='<div class="loading">No sheets found</div>';return}var g=document.getElementById('iframe-container');g.innerHTML='';e.forEach(function(h,i){var j=document.createElement('iframe');j.id='sheet-'+i;j.src=h.url;if(i===0)j.className='active';g.appendChild(j)});var k=document.getElementById('tabs');e.forEach(function(h,i){var j=document.createElement('div');j.className='tab'+(i===0?' active':'');j.textContent=h.title;j.onclick=function(){var l=g.getElementsByTagName('iframe');for(var m=0;m<l.length;m++)l[m].className='';document.getElementById('sheet-'+i).className='active';var n=k.getElementsByClassName('tab');for(var m=0;m<n.length;m++)n[m].className='tab';j.className='tab active'};k.appendChild(j)})}).catch(function(d){console.error('[Multi] Error:',d);document.getElementById('iframe-container').innerHTML='<div class="loading">Error: '+d.message+'</div>'})})();
</script>
</body>
</html>